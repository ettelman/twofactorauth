(function(){"use strict";var e={4894:function(e,t,s){var r=s(9242),a=s(4870),o=s(3396),n="data:image/png;base64,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";const i={key:0,id:"cookieMessage",class:"cookie-banner"},l={class:"cookie-content"},c=(0,o._)("p",null,"Vi använder cookies på vår webbplats för att förbättra din användarupplevelse och hålla dig inloggad mellan olika webbplatser. ",-1),d={id:"app"},u={class:"top"},g=(0,o._)("img",{src:n,alt:"Logotyp för Bonnier News",class:"logo"},null,-1),p=(0,o._)("i",{class:"pi pi-tag"},null,-1),m={class:"container"};function h(e,t,s,r,a,n){const h=(0,o.up)("router-view");return(0,o.wg)(),(0,o.iD)(o.HY,null,[r.showCookieMessage?((0,o.wg)(),(0,o.iD)("div",i,[(0,o._)("div",l,[c,(0,o._)("button",{onClick:t[0]||(t[0]=(...e)=>r.acceptCookies&&r.acceptCookies(...e))},"Godkänn")])])):(0,o.kq)("",!0),(0,o._)("div",d,[(0,o._)("div",u,[g,(0,o._)("a",{href:"#",class:"nav-link mobile-offset",onClick:t[1]||(t[1]=(...e)=>r.toggleTheme&&r.toggleTheme(...e))},[p,(0,o.Uk)("Ljust/mörkt tema")])]),(0,o._)("div",m,[(0,o.Wm)(h)])])],64)}var w=s(2483),k={name:"App",components:{RouterView:w.MA},setup(){const e=(0,a.iH)(!localStorage.getItem("cookiesAccepted")),t=()=>{localStorage.setItem("cookiesAccepted","true"),e.value=!1},s=()=>{document.body.classList.toggle("dark")};return{showCookieMessage:e,acceptCookies:t,toggleTheme:s}}},v=s(89);const f=(0,v.Z)(k,[["render",h]]);var b=f,y=s(7139);const E=e=>((0,o.dD)("data-v-248480ca"),e=e(),(0,o.Cn)(),e),_=E((()=>(0,o._)("h1",{class:"top-h"},"Logga in",-1))),T={class:"login"},A=E((()=>(0,o._)("label",{for:"email"},"Epostadress:",-1))),F={key:0,class:"error"},U=E((()=>(0,o._)("label",{for:"password"},"Lösenord:",-1))),D={key:0},S=E((()=>(0,o._)("label",{for:"twofactortoken"},"Engångslösenord:",-1))),M=E((()=>(0,o._)("button",null,"Logga in",-1))),C={key:1,class:"error"},L=E((()=>(0,o._)("i",{class:"pi pi-question-circle"},null,-1))),I=E((()=>(0,o._)("br",null,null,-1))),B=E((()=>(0,o._)("i",{class:"pi pi-key"},null,-1))),z=E((()=>(0,o._)("br",null,null,-1))),Z=E((()=>(0,o._)("i",{class:"pi pi-user"},null,-1))),q=E((()=>(0,o._)("br",null,null,-1)));function J(e,t,s,a,n,i){const l=(0,o.up)("router-link");return(0,o.wg)(),(0,o.iD)(o.HY,null,[_,(0,o._)("div",T,[(0,o._)("form",{onSubmit:t[4]||(t[4]=(0,r.iM)(((...e)=>i.login&&i.login(...e)),["prevent"])),novalidate:""},[(0,o._)("div",null,[A,(0,o.wy)((0,o._)("input",{type:"email",id:"email","onUpdate:modelValue":t[0]||(t[0]=e=>n.email=e),onBlur:t[1]||(t[1]=(...e)=>i.checkTwoFactor&&i.checkTwoFactor(...e))},null,544),[[r.nr,n.email]]),n.emailError?((0,o.wg)(),(0,o.iD)("p",F,(0,y.zw)(n.emailError),1)):(0,o.kq)("",!0)]),(0,o._)("div",null,[U,(0,o.wy)((0,o._)("input",{type:"password",id:"password","onUpdate:modelValue":t[2]||(t[2]=e=>n.password=e)},null,512),[[r.nr,n.password]])]),n.twoFactorAuth?((0,o.wg)(),(0,o.iD)("div",D,[S,(0,o.wy)((0,o._)("input",{type:"text",id:"twofactortoken","onUpdate:modelValue":t[3]||(t[3]=e=>n.twoFactorToken=e)},null,512),[[r.nr,n.twoFactorToken]])])):(0,o.kq)("",!0),M,n.error?((0,o.wg)(),(0,o.iD)("p",C,(0,y.zw)(n.error),1)):(0,o.kq)("",!0)],32),(0,o.Wm)(l,{class:"nav-link",to:"/reset"},{default:(0,o.w5)((()=>[L,(0,o.Uk)("Jag har glömt mitt lösenord")])),_:1}),I,(0,o.Wm)(l,{class:"nav-link",to:"/freja-eid-login"},{default:(0,o.w5)((()=>[B,(0,o.Uk)("Fortsätt med med Freja eID")])),_:1}),z,(0,o.Wm)(l,{class:"nav-link",to:"/registertwo"},{default:(0,o.w5)((()=>[Z,(0,o.Uk)("Registrera ny användare ")])),_:1}),q])],64)}s(7658);var j=s(4161),x={data(){return{email:"",password:"",twoFactorToken:"",twoFactorAuth:!1,error:"",validEmail:!1,emailError:""}},setup(){const e=(0,w.tv)();(0,o.bv)((()=>{j.Z.get("/authenticate").then((t=>{e.push("/secret")})).catch((e=>{}))}))},components:{RouterLink:w.rH},methods:{async checkTwoFactor(){try{const e=await j.Z.post("/check",{email:this.email});this.twoFactorAuth=e.data.twoFactor}catch(e){console.error("Error during checking two-factor authentication:",e)}},async login(){if(this.validateEmail(),!this.validEmail||this.password.length<6)this.password.length<6&&(this.error="Ditt lösenord måste vara minst 6 tecken långt");else try{const e=await j.Z.post("/login",{email:this.email,password:this.password,twoFactorToken:this.twoFactorToken});"success"===e.data.status?this.$router.push("/secret"):this.error=e.data.error||"Fel epost och/eller lösenord"}catch(e){this.error="Inloggningen misslyckades, var god försök igen senare."}},validateEmail(){const e=/^[\w-]+(\.[\w-]+)*@([\w-]+\.)+[a-zA-Z]{2,7}$/;e.test(this.email)?(this.emailError="",this.validEmail=!0):this.emailError='Epostadressen måste vara i formatet "namn@domän.se"'}}};const N=(0,v.Z)(x,[["render",J],["__scopeId","data-v-248480ca"]]);var V=N,R=s.p+"img/FrejaWhite.0ff2ca8d.svg";const P=(0,o._)("div",{class:"top-h"},[(0,o._)("h1",{class:"white-h1"},"Logga in med"),(0,o.Uk)(),(0,o._)("img",{src:R,alt:"Freja",class:"freja-logo"})],-1),Y={class:"login"},H=(0,o._)("label",{for:"login"},"Epost eller personnummer:",-1),O=(0,o._)("br",null,null,-1),X=["disabled"],G=(0,o._)("br",null,null,-1),W=["disabled"],Q=(0,o._)("div",{class:"infobox margin"},[(0,o._)("p",null,"Ange E-post eller personnummer i fältet. Använd sedan Freja Eid mobilapplikation för att identifiera dig. Epost måste vara i formatet namn@domän.se och personnummer vara i formatet ååååmmddxxxx (exempelvis: 196303053355) ")],-1),K={class:"login"},$=(0,o._)("i",{class:"pi pi-chevron-left"},null,-1);function ee(e,t,s,a,n,i){const l=(0,o.up)("router-link");return(0,o.wg)(),(0,o.iD)(o.HY,null,[P,(0,o._)("div",Y,[(0,o._)("form",{onSubmit:t[1]||(t[1]=(0,r.iM)(((...e)=>i.submitForm&&i.submitForm(...e)),["prevent"]))},[H,O,(0,o.wy)((0,o._)("input",{id:"login","onUpdate:modelValue":t[0]||(t[0]=e=>n.login=e),type:"text",disabled:n.isLoading,required:""},null,8,X),[[r.nr,n.login]]),G,(0,o._)("button",{type:"submit",disabled:n.isLoading},(0,y.zw)(n.isLoading?"Laddar...":"Logga in"),9,W)],32),n.message?((0,o.wg)(),(0,o.iD)("div",{key:0,class:(0,y.C_)([{success:n.isSuccess,error:!n.isSuccess},"big-msg"])},(0,y.zw)(n.message),3)):(0,o.kq)("",!0)]),Q,(0,o._)("div",K,[(0,o.Wm)(l,{class:"nav-link",to:"/"},{default:(0,o.w5)((()=>[$,(0,o.Uk)("Tillbaka")])),_:1})])],64)}var te={data(){return{login:"",message:"",isLoading:!1,isSuccess:!1}},components:{RouterLink:w.rH},methods:{async submitForm(){this.isLoading=!0,this.isSuccess=!0,this.message="Öppna Freja Eid på din mobiltelefon";const e=this.login.includes("@")?"email":"ssn";try{const t=await j.Z.post("/freja",{login:this.login,type:e});this.isLoading=!1,"success"===t.data.status?this.$router.push("/secret"):(this.message="Fel vid inloggning, svar från freja: "+t.data.status,this.isLoading=!1,this.isSuccess=!1)}catch(t){this.isLoading=!1,this.message="Fel epost eller personnummer",this.isSuccess=!1,console.error(t)}}}};const se=(0,v.Z)(te,[["render",ee]]);var re=se;const ae=e=>((0,o.dD)("data-v-c02b5240"),e=e(),(0,o.Cn)(),e),oe=ae((()=>(0,o._)("h1",{class:"top-h"},"Registrera ny användare",-1))),ne={class:"login"},ie=ae((()=>(0,o._)("div",{class:"infobox"},[(0,o._)("p",null,[(0,o.Uk)("Din epost måste vara i formatet namn@domän.se "),(0,o._)("br"),(0,o.Uk)(" Ditt lösenord måste vara minst 6 tecken långt."),(0,o._)("br"),(0,o.Uk)("Alla fält är obligatoriska")])],-1))),le=ae((()=>(0,o._)("label",{for:"email"},"Epostadress:",-1))),ce={key:0,class:"error"},de=ae((()=>(0,o._)("label",{for:"password"},"Lösenord",-1))),ue=ae((()=>(0,o._)("label",{class:"top-margin",for:"confirm"},"Upprepa lösenord",-1))),ge=ae((()=>(0,o._)("button",{type:"submit"},"Registrera",-1))),pe={key:2,class:"error-message"},me={key:3,class:"success-message"},he={class:"flex"},we=ae((()=>(0,o._)("div",{class:"infobox"},[(0,o._)("p",null,[(0,o.Uk)("När du registrerar dig lagras din e-postadress i vår databas. Genom att skapa en ny användare accepterar du detta. "),(0,o._)("br"),(0,o.Uk)(" När du loggar in sparas din epostadress i en kaka för att hålla dig inloggad på servern")])],-1)));function ke(e,t,s,a,n,i){const l=(0,o.up)("two-factor-setup"),c=(0,o.up)("router-link");return(0,o.wg)(),(0,o.iD)(o.HY,null,[oe,(0,o._)("div",ne,[n.showTwoFactorSetup?((0,o.wg)(),(0,o.j4)(l,{key:1,sentEmail:n.email},null,8,["sentEmail"])):((0,o.wg)(),(0,o.iD)("form",{key:0,onSubmit:t[5]||(t[5]=(0,r.iM)(((...e)=>i.register&&i.register(...e)),["prevent"]))},[ie,(0,o._)("div",null,[le,(0,o.wy)((0,o._)("input",{type:"email",id:"email","onUpdate:modelValue":t[0]||(t[0]=e=>n.email=e),onBlur:t[1]||(t[1]=(...e)=>i.validateEmail&&i.validateEmail(...e))},null,544),[[r.nr,n.email]]),n.emailError?((0,o.wg)(),(0,o.iD)("p",ce,(0,y.zw)(n.emailError),1)):(0,o.kq)("",!0)]),(0,o._)("div",null,[de,(0,o.wy)((0,o._)("input",{type:"password",id:"password","onUpdate:modelValue":t[2]||(t[2]=e=>n.password=e),onInput:t[3]||(t[3]=(...e)=>i.checkPasswordStrength&&i.checkPasswordStrength(...e))},null,544),[[r.nr,n.password]]),(0,o.Uk)(" Lösenordsstyrka: "),(0,o._)("span",{class:(0,y.C_)(n.passwordStrength.class)},(0,y.zw)(n.passwordStrength.message),3),ue,(0,o.wy)((0,o._)("input",{type:"password",id:"confirm","onUpdate:modelValue":t[4]||(t[4]=e=>n.confirm=e)},null,512),[[r.nr,n.confirm]])]),ge],32)),n.errorMessage?((0,o.wg)(),(0,o.iD)("div",pe,(0,y.zw)(n.errorMessage),1)):(0,o.kq)("",!0),n.successMessage?((0,o.wg)(),(0,o.iD)("div",me,(0,y.zw)(n.successMessage),1)):(0,o.kq)("",!0),(0,o._)("div",he,[(0,o.Uk)(" Är du redan registrerad? "),(0,o.Wm)(c,{class:"solo-link",to:"/"},{default:(0,o.w5)((()=>[(0,o.Uk)("Logga in")])),_:1})]),we])],64)}const ve=e=>((0,o.dD)("data-v-f37d19de"),e=e(),(0,o.Cn)(),e),fe=ve((()=>(0,o._)("h1",null,"Registrera tvåstegsinloggning",-1))),be={class:"twofactor"},ye=ve((()=>(0,o._)("div",{class:"infobox"},[(0,o._)("p",null,[(0,o.Uk)('För att registrera tvåstegsinloggning behöver du en authenticator app. Det finns många att välja mellan på både android eller iphone appstore. Sök på "Authenticator" '),(0,o._)("br"),(0,o.Uk)(" Om du vill ha en authenticator i din webbläsare kan du använda "),(0,o._)("a",{href:"https://play.google.com/store/apps/details?id=com.google.android.apps.authenticator2&hl=en&gl=US",class:"solo-link"},"Google Authenticator")])],-1))),Ee=ve((()=>(0,o._)("label",{for:"email"},"Epostadress:",-1))),_e=ve((()=>(0,o._)("label",{for:"password"},"Lösenord:",-1))),Te=ve((()=>(0,o._)("button",null,"Initiera tvåstegsinloggning",-1))),Ae=["src"],Fe=ve((()=>(0,o._)("h2",null,"Verifiera tvåstegsinloggning (frivilligt)",-1))),Ue=ve((()=>(0,o._)("label",{for:"passw"},"Engångslösenord",-1))),De=ve((()=>(0,o._)("button",null,"Verifiera tvåstegsinloggning",-1))),Se={key:3};function Me(e,t,s,a,n,i){return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("button",{onClick:t[0]||(t[0]=(...e)=>i.skipTwoFactor&&i.skipTwoFactor(...e))},"Skippa tvåstegsinloggning"),fe,(0,o._)("div",be,[ye,n.qrCodeImageUrl?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("form",{key:0,onSubmit:t[3]||(t[3]=(0,r.iM)(((...e)=>i.setupTwoFactor&&i.setupTwoFactor(...e)),["prevent"]))},[(0,o._)("div",null,[Ee,(0,o.wy)((0,o._)("input",{type:"email",id:"email","onUpdate:modelValue":t[1]||(t[1]=e=>n.email=e)},null,512),[[r.nr,n.email]])]),(0,o._)("div",null,[_e,(0,o.wy)((0,o._)("input",{type:"password",id:"password","onUpdate:modelValue":t[2]||(t[2]=e=>n.password=e)},null,512),[[r.nr,n.password]])]),Te],32)),n.qrCodeImageUrl?((0,o.wg)(),(0,o.iD)("img",{key:1,src:n.qrCodeImageUrl,alt:"QR-kod"},null,8,Ae)):(0,o.kq)("",!0),n.qrCodeImageUrl?((0,o.wg)(),(0,o.iD)("form",{key:2,onSubmit:t[5]||(t[5]=(0,r.iM)(((...e)=>i.verifyTwoFactor&&i.verifyTwoFactor(...e)),["prevent"]))},[(0,o._)("div",null,[Fe,Ue,(0,o.wy)((0,o._)("input",{type:"text",id:"passw","onUpdate:modelValue":t[4]||(t[4]=e=>n.token=e)},null,512),[[r.nr,n.token]])]),De],32)):(0,o.kq)("",!0),n.error?((0,o.wg)(),(0,o.iD)("p",Se,(0,y.zw)(n.error),1)):(0,o.kq)("",!0)])],64)}var Ce={data(){return{email:this.sentEmail,password:"",qrCodeImageUrl:"",token:"",error:""}},props:{sentEmail:{type:String,required:!1}},methods:{async setupTwoFactor(){try{const e=await j.Z.post("/setup",{email:this.email,password:this.password});this.qrCodeImageUrl=e.data.qrCodeImageUrl}catch(e){this.error="Ett fel uppstod vid tvåstegsinloggning, var god försök igen senare."}},async verifyTwoFactor(){try{const e=await j.Z.post("/verify",{email:this.email,token:this.token});"success"===e.data.status?this.$router.push("/"):this.error="Verifikationen misslyckades. Försök igen"}catch(e){this.error="Något gick fel vid verifikationen. Var god försök igen senare"}},skipTwoFactor(){this.$router.push("/")}}};const Le=(0,v.Z)(Ce,[["render",Me],["__scopeId","data-v-f37d19de"]]);var Ie=Le,Be={data(){return{email:"",password:"",confirm:"",errorMessage:"",successMessage:"",emailError:"",showTwoFactorSetup:!1,validEmail:!1,passwordStrength:{class:"",message:""}}},components:{TwoFactorSetup:Ie},methods:{async register(){if(!this.validEmail||this.password.length<6||this.password!==this.confirm)return this.password.length<6&&(this.errorMessage="Ditt lösenord måste vara minst 6 tecken långt"),void(this.password!==this.confirm&&(this.errorMessage="Lösenorden matchar inte"));try{await j.Z.post("/register",{email:this.email,password:this.password}),this.errorMessage="",this.successMessage="Registreringen är nu klar. Du kan logga in.",this.showTwoFactorSetup=!0}catch(e){console.error("Error during registration:",e),this.errorMessage="Ett fel inträffade vid registrering, kontakta supporten."}},validateEmail(){const e=/^[\w-]+(\.[\w-]+)*@([\w-]+\.)+[a-zA-Z]{2,7}$/;e.test(this.email)?(this.emailError="",this.validEmail=!0):this.emailError='Epostadressen måste vara i formatet "namn@domän.se"'},checkPasswordStrength(){const e=new RegExp("^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*])(?=.{8,})"),t=new RegExp("^(((?=.*[a-z])(?=.*[A-Z]))|((?=.*[a-z])(?=.*[0-9]))|((?=.*[A-Z])(?=.*[0-9])))(?=.{6,})");e.test(this.password)?(this.passwordStrength.class="strong",this.passwordStrength.message="Starkt"):t.test(this.password)?(this.passwordStrength.class="medium",this.passwordStrength.message="Medium"):(this.passwordStrength.class="weak",this.passwordStrength.message="Svagt")}}};const ze=(0,v.Z)(Be,[["render",ke],["__scopeId","data-v-c02b5240"]]);var Ze=ze;const qe=(0,o._)("h1",{class:"top-h"},"Inloggad",-1),Je=(0,o._)("br",null,null,-1);function je(e,t,s,r,a,n){return(0,o.wg)(),(0,o.iD)("div",null,[qe,(0,o.Uk)(" Inloggad som: "+(0,y.zw)(r.userEmail)+" ",1),Je,(0,o._)("button",{onClick:t[0]||(t[0]=(...e)=>n.logout&&n.logout(...e))},"Logga ut")])}var xe={setup(){const e=(0,a.iH)("");return j.Z.get("/authenticate").then((t=>{e.value=t.data.email})).catch((e=>{console.error("Felmeddelande:",e)})),{userEmail:e}},methods:{logout(){j.Z.post("/logout",{},{withCredentials:!0}).then((e=>{console.log(e),this.$router.push("/")})).catch((e=>{console.log(e)}))}}};const Ne=(0,v.Z)(xe,[["render",je]]);var Ve=Ne;const Re=(0,o._)("h1",{class:"top-h"},"Glömt lösenord?",-1),Pe={class:"login"},Ye=(0,o._)("div",{class:"infobox"},[(0,o._)("p",null,"Skriv in den e-postadress du använde när du skapade kontot. Om mejlet inte kommer fram kan du behöva kolla din skräppost.")],-1),He=(0,o._)("label",{for:"email"},"Epostadress:",-1),Oe=(0,o._)("br",null,null,-1),Xe=(0,o._)("input",{type:"email",id:"email"},null,-1),Ge=(0,o._)("button",{type:"submit"}," Skicka återställningslänk ",-1),We=[He,Oe,Xe,Ge],Qe={class:"login"},Ke=(0,o._)("i",{class:"pi pi-chevron-left"},null,-1);function $e(e,t){const s=(0,o.up)("router-link");return(0,o.wg)(),(0,o.iD)(o.HY,null,[Re,(0,o._)("div",Pe,[Ye,(0,o._)("form",{onSubmit:t[0]||(t[0]=(0,r.iM)((()=>{}),["prevent"]))},We,32)]),(0,o._)("div",Qe,[(0,o.Wm)(s,{class:"nav-link",to:"/"},{default:(0,o.w5)((()=>[Ke,(0,o.Uk)("Tillbaka")])),_:1})])],64)}const et={},tt=(0,v.Z)(et,[["render",$e]]);var st=tt;const rt=[{path:"/",name:"TwoFactorLogin",component:V},{path:"/freja-eid-login",name:"FrejaEidLogin",component:re},{path:"/registertwo",name:"RegisterTwo",component:Ze},{path:"/secret",name:"SecretView",component:Ve,meta:{requiresAuth:!0}},{path:"/reset",name:"ResetView",component:st}],at=(0,w.p7)({history:(0,w.PO)("/"),routes:rt});at.beforeEach(((e,t,s)=>{e.matched.some((e=>e.meta.requiresAuth))?j.Z.get("/authenticate").then((()=>{s()})).catch((()=>{s({name:"TwoFactorLogin",query:{redirect:e.fullPath}})})):s()}));var ot=at,nt=s(966);const it=(0,r.ri)(b);(0,a.iH)(!1);it.use(nt.Z),(0,r.ri)(b).use(ot).mount("#app")}},t={};function s(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,s),o.exports}s.m=e,function(){var e=[];s.O=function(t,r,a,o){if(!r){var n=1/0;for(d=0;d<e.length;d++){r=e[d][0],a=e[d][1],o=e[d][2];for(var i=!0,l=0;l<r.length;l++)(!1&o||n>=o)&&Object.keys(s.O).every((function(e){return s.O[e](r[l])}))?r.splice(l--,1):(i=!1,o<n&&(n=o));if(i){e.splice(d--,1);var c=a();void 0!==c&&(t=c)}}return t}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[r,a,o]}}(),function(){s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,{a:t}),t}}(),function(){s.d=function(e,t){for(var r in t)s.o(t,r)&&!s.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){s.p="/"}(),function(){var e={143:0};s.O.j=function(t){return 0===e[t]};var t=function(t,r){var a,o,n=r[0],i=r[1],l=r[2],c=0;if(n.some((function(t){return 0!==e[t]}))){for(a in i)s.o(i,a)&&(s.m[a]=i[a]);if(l)var d=l(s)}for(t&&t(r);c<n.length;c++)o=n[c],s.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return s.O(d)},r=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=s.O(void 0,[998],(function(){return s(4894)}));r=s.O(r)})();
//# sourceMappingURL=app.b57dd2c3.js.map